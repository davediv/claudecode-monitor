# TypeScript Setup Documentation

## Overview
This document describes the TypeScript configuration for the Claude Code Version Monitor Cloudflare Worker project.

## Configuration Files

### tsconfig.json
The main TypeScript configuration with:
- **Target**: ES2021 (compatible with Cloudflare Workers runtime)
- **Module**: ES2022
- **Strict Mode**: Enabled for maximum type safety
- **Path Aliases**: `@/*` maps to `src/*` for cleaner imports

### worker-configuration.d.ts
Auto-generated by Wrangler containing:
- Cloudflare Worker runtime types
- Environment variable bindings (Env interface)
- KV namespace types

## Type Organization

### src/types/index.d.ts
Contains:
- Cloudflare Worker event types (`ScheduledEvent`, `ExecutionContext`)
- Worker handler interfaces (`ExportedHandler`)
- Application-specific types (`AppConfig`)
- Custom error types (`WorkerError`)

### src/types/global.d.ts
Makes the `Env` interface available globally without imports.

## Type Safety Features

### Environment Variables
All environment variables are strongly typed through the `Env` interface:
```typescript
interface Env {
  VERSION_STORAGE: KVNamespace;
  GITHUB_CHANGELOG_URL: string;
  TELEGRAM_CHAT_ID: string;
  TELEGRAM_BOT_TOKEN: string;
}
```

### Configuration Helper
The `src/config.ts` module provides type-safe configuration access:
```typescript
const config = createConfig(env);
validateConfig(config); // Throws if invalid
```

## Development Workflow

### Type Checking
Run TypeScript type checking without compilation:
```bash
npx tsc --noEmit
```

### Regenerating Types
After modifying `wrangler.jsonc`:
```bash
npm run cf-typegen
```

### IDE Support
The configuration provides full IntelliSense support in:
- VS Code
- WebStorm/IntelliJ
- Any TypeScript-aware editor

## Common Type Patterns

### Worker Handler
```typescript
export default {
  async scheduled(event: ScheduledEvent, env: Env, ctx: ExecutionContext): Promise<void> {
    // Implementation
  }
} satisfies ExportedHandler<Env>;
```

### Using KV Storage
```typescript
// Type-safe KV operations
const data = await env.VERSION_STORAGE.get<StorageState>('key', 'json');
await env.VERSION_STORAGE.put('key', JSON.stringify(data));
```

### Error Handling
```typescript
throw new WorkerError('Failed to fetch', 'FETCH_ERROR', { url });
```

## Troubleshooting

### "Cannot find name 'Env'"
- Run `npm run cf-typegen` to regenerate types
- Ensure `worker-configuration.d.ts` is included in `tsconfig.json`

### Type errors after wrangler.jsonc changes
- Always run `npm run cf-typegen` after modifying bindings
- Restart TypeScript language server in your IDE

### Module resolution issues
- Use path aliases: `import { something } from '@/utils'`
- Ensure `baseUrl` and `paths` are configured in `tsconfig.json`